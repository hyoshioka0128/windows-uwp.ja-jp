---
description: 前のトピック (「リソース管理システムでのリソースの照合と選択の仕組み」) では、一般的な修飾子の照合について説明しました。 このトピックでは、言語タグの照合についてさらに詳しく説明します。
title: リソース管理システムでの言語タグの照合の仕組み
template: detail.hbs
ms.date: 11/02/2017
ms.topic: article
keywords: Windows 10, UWP, リソース, 画像, アセット, MRT, 修飾子
ms.localizationpriority: medium
ms.openlocfilehash: 3c5b2d595585cabdfb9f2983f2ad87f05b7fa5a4
ms.sourcegitcommit: a3bbd3dd13be5d2f8a2793717adf4276840ee17d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2020
ms.locfileid: "93031885"
---
# <a name="how-the-resource-management-system-matches-language-tags"></a>リソース管理システムでの言語タグの照合の仕組み

前のトピック (「[リソース管理システムでのリソースの照合と選択の仕組み](how-rms-matches-and-chooses-resources.md)」) では、一般的な修飾子の照合について説明しました。 このトピックでは、言語タグの照合についてさらに詳しく説明します。

## <a name="introduction"></a>はじめに

言語タグの修飾子を持つリソースは、アプリの実行時の言語の一覧に基づいて比較およびスコア付けされます。 さまざまな言語の一覧の定義については、「[ユーザー プロファイルの言語とアプリ マニフェストの言語について](../design/globalizing/manage-language-and-region.md)」を参照してください。 一覧内の最初の言語の対応付けが、一覧内の 2 つ目の言語の対応付けよりも先に発生します (他の地域バリアントのものであっても同様)。 たとえば、アプリの実行時の言語が en-US に指定されていると、fr-CA リソースより優先的に en-GB のリソースが選ばれます。 en という形式のリソースがない場合に限り、fr-CA のリソースが選ばれます (その場合、アプリの既定の言語が任意の形式の en に設定できないことに注意してください)。

スコア付けメカニズムでは、[BCP-47](https://tools.ietf.org/html/bcp47) サブタグ レジストリに含まれているデータと、その他のデータ ソースを使います。 一致の度合いに応じたスコアにすることができ、候補が複数あるときは一致スコアが最も高い候補を選びます。

したがって、言語コンテンツに汎用的な言語タグを付けることができますが、必要に応じて特定言語のコンテンツを指定することもできます。 たとえば、アプリに、米国、英国、その他の地域に共通する英語の文字列が多数含まれているとします。 これらの文字列に "en" (英語) というタグを付けるだけで、領域とローカライズのオーバーヘッドを節約できます。 "color/colour" が含まれる文字列など、区別が必要になった場合は、米国バージョンと英国バージョンにそれぞれ個別に、言語と地域の両方のサブタグを使用して、"en-US" と "en-GB" というタグを付けることができます。

## <a name="language-tags"></a>言語タグ

言語は、正規化された整形式の BCP-47 言語タグを使って識別されます。 サブタグのコンポーネントは BCP-47 サブタグ レジストリ内で定義されます。 標準的な構造の BCP-47 言語タグは、次に示す 1 つ以上のサブタグ要素から構成されます。

- 言語サブタグ (必須)。
- スクリプト サブタグ (サブタグ レジストリで指定された既定値を使って推論される場合があります)。
- 地域サブタグ (省略可能)。
- バリアント サブタグ (省略可能)。

サブタグ要素は他にもありますが、言語の対応付けにはほとんど影響しません。 " *" のように、ワイルドカード ("en-* ") を使って定義された言語の範囲はありません。

## <a name="matching-two-languages"></a>2 つの言語の対応付け

Windows で 2 つの言語の比較が行われる場合は、通常、より大きなプロセスのコンテキスト内で実行されます。 たとえば、アプリの言語の一覧を生成する場合など、複数言語を評価するコンテキスト内で実行されることがあります (「[ユーザー プロファイルの言語とアプリ マニフェストの言語について](../design/globalizing/manage-language-and-region.md)」を参照)。 Windows は、ユーザー設定の複数の言語とアプリ マニフェストで指定された言語を対応付けてこの処理を実行します。 また、比較は、特定のリソースの他の修飾子と共に言語を評価するコンテキスト内で実行されることもあります。 一例として、リソース選択時に考慮する (言語以外の) 要因としてユーザーの国/地域情報やデバイスの現在の表示倍率または dpi を使って、特定のリソース コンテキストに対して特定のファイル リソースを決定する場合があります。

2 つの言語のタグが比較され、その比較に対して、一致の度合いに応じたスコアが割り当てられます。

| 一致する | Score | 例 |
| ----- | ----- | ------- |
| 完全一致 | 最高 | en-AU : en-AU |
| バリアントの一致 (言語、スクリプト、地域、バリアント) |  | en-AU-variant1 : en-AU-variant1-t-ja |
| 地域の一致 (言語、スクリプト、地域) |  | en-AU : en-AU-variant1 |
| 部分一致 (言語、スクリプト) |  |  |
| - マクロ地域の一致 |  | en-AU : en-053 |
| - 地域中立の一致 |  | en-AU : en |
| - 正字法の類似性の一致 (限定的なサポート) |  | en-AU : en-GB |
| - 優先する地域の一致 |  | en-AU : en-US |
| - 任意の地域の一致 |  | en-AU : en-CA |
| 未定義の言語 (任意の言語の一致) |  | en-AU : und |
| 不一致 (スクリプトの不一致または第 1 言語のタグの不一致) | 最低 | en-AU : fr-FR |

### <a name="exact-match"></a>完全一致

タグが完全に等しい (すべてのサブタグ要素が一致している)。 バリアントの一致または地域の一致からこのタイプの一致に、比較が昇格する場合があります。 たとえば、en-US は en-US に対応付けられます。

### <a name="variant-match"></a>バリアントの一致

タグの言語、スクリプト、地域、バリアントの各サブタグは一致していますが、他の点が異なっています。

### <a name="region-match"></a>地域の一致

タグの言語、スクリプト、地域の各サブタグは一致していますが、他の点が異なっています。 たとえば、de-DE-1996 は de-DE に対応付けられ、en-US-x-Pirate は en-US に対応付けられます。

### <a name="partial-matches"></a>部分一致

タグの言語とスクリプトの各サブタグは一致していますが、地域やその他のサブタグが異なっています。 たとえば、en-us は en に一致し、en-us は en-us に一致 \* します。

#### <a name="macro-region-match"></a>マクロ地域の一致

タグの言語サブタグとスクリプト サブタグは一致しています。両方のタグに地域サブタグがあり、その片方がもう片方の地域を含むマクロ地域を表しています。 マクロ地域サブタグは常に数字で、国連統計部 M.49 の国コードと地域コードに由来します。 地域の包含関係について詳しくは、「[Composition of macro geographic (continental) regions, geographical sub-regions, and selected economic and other groupings (マクロ地理 (大陸) 地域、地理サブ地域、選ばれた経済グループなどのグループ分けの構成)](https://unstats.un.org/unsd/methods/m49/m49regin.htm)」をご覧ください。

**注** "経済的グループ分け" または "その他のグループ分け" に関する国連コードは、BCP-47 ではサポートされていません。
 
**注** マクロ地域サブタグが "001" のタグは地域中立タグと同等と見なされます。 たとえば、"es-001" と "es" は同義語として扱われます。

#### <a name="region-neutral-match"></a>地域中立の一致

タグの言語サブタグとスクリプト サブタグは一致していますが、一方のタグだけに地域サブタグがあります。 親の一致は、他の部分一致よりも優先されます。

#### <a name="orthographic-affinity-match"></a>正字法の類似性の一致

タグの言語サブタグとスクリプト サブタグは一致していますが、地域サブタグには正字法の類似性のみがあります。 類似性は、言語固有の類似性が高い地域 ("en-IE" と "en-GB" など) を定義した Windows で保守されているデータに依存します。

#### <a name="preferred-region-match"></a>優先する地域の一致

タグの言語サブタグとスクリプト サブタグは一致していて、一方の地域サブタグがその言語の既定の地域サブタグになっています。 たとえば、"fr-FR" は "fr" サブタグの既定の地域です。 そのため、fr-FR は fr-CA より fr-BE に強く対応付けられます。 これは、Windows がローカライズされる各言語の既定の地域を定義した Windows で保守されているデータに依存します。

#### <a name="sibling-match"></a>兄弟の一致

タグの言語サブタグとスクリプト サブタグは一致していて、両方に地域サブタグもありますが、それ以外の関係が定義されていません。 兄弟の一致が複数ある場合、より上位の一致がなければ、最後に列挙された兄弟が採用されます。

### <a name="undetermined-language"></a>未定義の言語

リソースに "und" というタグを付けて、任意の言語と一致することを示すことができます。 このタグをスクリプト タグと共に使って、スクリプトに基づく一致をフィルター処理することもできます。 たとえば、"und-Latn" は、Latin スクリプトを使う任意の言語タグに一致します。 詳細については、以下を参照してください。

### <a name="script-mismatch"></a>スクリプトの不一致

タグの第 1 言語のタグのみが一致し、スクリプト タグが一致しない場合、この組み合わせは不一致と見なされ、有効な一致のレベルよりも低いスコアになります。

### <a name="no-match"></a>一致なし。

第 1 言語のサブタグの不一致は、有効な一致のレベルよりも低いスコアになります。 たとえば、zh-Hant は zh-Hans に対応付けられません。

## <a name="examples"></a>例

ユーザーの言語 "zh-Hans-CN" (簡体中国語 (中国)) は、以下に示すリソースと次のような優先順位で一致します。 X は不一致を示します。

![簡体中国語 (中国) の照合](images/language_matching_1.png)

1. 完全一致。2.  と 3.  地域の一致。4.  親の一致。5.  兄弟の一致。

言語サブタグで、BCP-47 サブタグ レジストリで定義されているスクリプトの値が抑制されている場合、抑制されたスクリプト コードを使って同様の対応付けが行われます。 たとえば、en-Latn-US は en-US に対応付けられます。 次の例では、ユーザーの言語は "en-AU" (英語 (オーストラリア)) です。

![英語 (オーストラリア) の照合](images/language_matching_2.png)

1. 完全一致。2.  マクロ地域の一致。3.  地域中立の一致。4.  正字法の類似性の一致。5.  優先する地域の一致。6.  兄弟の一致。

## <a name="matching-a-language-to-a-language-list"></a>言語と言語の一覧との対応付け

単一の言語と言語の一覧の対応付けという大きなプロセスの一環として対応付けが発生する場合があります。 たとえば、単一の言語ベースのリソースとアプリの言語の一覧の対応付けが行われることがあります。 一致のスコアは、一覧内で最初に一致した言語の位置によって重み付けされます。 言語が一覧内で低い位置にあれば、スコアも低くなります。

言語の一覧に、言語サブタグとスクリプト サブタグが同じである地域バリアントが複数含まれている場合、最初の言語タグに対する比較のスコア付けは、完全一致、バリアントの一致、地域の一致についてのみ実行されます。 部分一致のスコア付けは、最後の地域バリアントまで後回しにされます。 これにより、ユーザーは言語の一覧に対する対応付けの動作を細かく制御できます。 対応付けの動作では、たとえば、一覧の 3 番目の項目の言語とスクリプトが 1 番目の項目と一致する場合に、1 番目の項目に対する部分一致よりも 2 番目の項目に対する完全一致を優先したりできます。 次に例を示します。

- 言語の一覧の順序: pt-PT (ポルトガル語 (ポルトガル))、en-US (英語 (米国))、pt-BR (ポルトガル語 (ブラジル))。
- リソース: "en-US"、"pt-BR"。
- よりスコアの高いリソース: "en-US"。
- 説明: まず "pt-PT" から比較を始めますが、完全一致はありません。 ユーザーの言語の一覧に "pt-BR" があるので、"pt-BR" に対する部分一致は後回しにされます。 次に比較する言語は "en-US" で、完全一致があります。 そのため、採用されるリソースは "en-US" になります。

OR

- 言語の一覧の順序: "es-MX" (スペイン語 (メキシコ))、"es-HO" (スペイン語 (ホンジュラス))。
- リソース: "en-ES"、"es-HO"。
- よりスコアの高いリソース: "es-HO"。

## <a name="undetermined-language-und"></a>未定義の言語 ("und")

言語タグ "und" は、よりよい一致が見つからない場合に、すべての言語に一致するリソースを指定するために使うことができます。 これは、BCP-47 言語の範囲 " *" または "* スクリプト" に類似していると見なすことができ - &lt; &gt; ます。 次に例を示します。

- 言語の一覧: "en-US"、"zh-Hans-CN"。
- リソース: "zh-Hans-CN"、"und"。
- よりスコアの高いリソース: "und"。
- 説明: まず "en-US" から比較を始めますが、"en" に基づいた部分一致以上の一致はありません。 "und" のタグが付いたリソースがあるので、対応付けアルゴリズムはこれを使います。

"und" タグを使うことにより、複数の言語が 1 つのリソースを共有し、個々の言語を例外として処理することができます。 次に例を示します。

- 言語の一覧: "zh-Hans-CN"、"en-US"。
- リソース: "zh-Hans-CN"、"und"。
- よりスコアの高いリソース: "zh-Hans-CN"。
- 説明: 比較の結果、1 番目の項目で完全一致が見つかったので、"und" というラベルの付いたリソースのチェックは行われません。

"und" をスクリプト タグと共に使って、リソースをスクリプトでフィルター処理できます。 次に例を示します。

- 言語の一覧: "ru"。
- リソース: "und-Latn"、"und-Cyrl"、"und-Arab"。
- よりスコアの高いリソース: "und-Cyrl"。
- 説明: "ru" に対する比較では部分一致以上の一致が見つからないので、言語タグ "und" が一致します。 言語タグ "ru" に関連付けられた抑制スクリプト値 "Cyrl" が、リソース "und-Cyrl" に一致します。

## <a name="orthographic-regional-affinity"></a>正字法の地域の類似性

地域サブタグが異なる 2 つの言語タグが一致する場合、特定の地域のペアは互いに、他の地域に比べて類似性が強くなります。 類似したグループがサポートされるのは、英語 ("en") のみです。 地域サブタグ "PH" (フィリピン) と "LR" (リベリア) は、"US" 地域サブタグに対して正字法の類似性を持ちます。 他のすべての地域サブタグは、"GB" (英国) 地域サブタグに類似します。 したがって、"en-US" と "en-GB" の両方のリソースが利用可能な場合、"en-HK" (英語 (香港特別行政区)) の言語の一覧では、"en-US" のリソースよりも "en-GB" のリソースの方がスコアが高くなります。

## <a name="handling-languages-with-many-regional-variants"></a>多くの地域バリアントを持つ言語の処理

一部の言語は大きな話者コミュニティを持ち、地域が異なると、その言語の変種を使っています &mdash; 英語やフランス語、スペイン語などが、多言語アプリでよくサポートされているその種の言語です。 地域の違いには、正書法の違い (たとえば、"color" と "colour") や語彙のような方言の違い (たとえば、"truck" と "lorry") があります。

このように地域バリアントが多い言語は、世界対応のアプリを作るときに問題になります。"どれぐらいの数の地域バリアントをサポートすればいいのか"、 "どれをサポートすればいいのか"、 "アプリで地域バリアントを管理する最も費用対効果の高い方法はどれか"、 といった疑問のすべてに答えることは、このトピックの範囲を超えています。 ただし、Windows に用意されている言語の対応付けのメカニズムは、地域バリアントを処理するときに役立つ機能を備えています。

アプリは多くの場合、どの言語でも 1 種類の変種しかサポートしません。 地域を問わず英語の話者に使われることが想定されているアプリに、英語の変種用のリソースが 1 種類しか用意されていないとしてみましょう。 この場合、地域サブタグのないタグ "en" がこの想定を反映したものになります。 しかし、アプリでは従来、地域サブタグを含む "en-US" のようなタグを使ってきた可能性があります。 この場合、それでも問題ありません。アプリは英語の 1 種類の変種しか使わず、Windows は、ある地域バリアントのタグの付いたリソースを、ユーザー言語設定を使って異なる地域バリアントに適切な方法で対応付けます。

ただし、複数の地域バリアントをサポートする場合は、たとえば "en" と "en-US" との違いがユーザー エクスペリエンスに大きな影響を及ぼすことがあり、どの地域サブタグを使うかが重要な問題になります。

カナダのフランス語と欧州のフランス語のように、それぞれ別のフランス語版を用意するとします。 カナダ フランス語の場合、"fr-CA" を使うことができます。 欧州の話者向けには、ローカライズ時にフランス語 (フランス) を使うため、"fr-FR" を使うことができます。 しかし、ベルギー出身のユーザーで言語設定を "fr-BE" にしている場合はどうなるでしょうか。どちらが使われるのでしょうか。 地域 "BE" は "FR" と "CA" のどちらとも異なり、どちらも "任意の地域" の一致とされます。 ただし、フランスはフランス語の優先する地域です。そのためこの場合は、"fr-FR" が最善の一致と見なされます。

最初は、フランス語の 1 変種だけでアプリをローカライズしていて、フランス語 (フランス) 文字列を使っていたのに、一般的な "fr" と指定しており、新しくカナダ フランス語もサポート対象に加えるとします。 おそらくカナダ フランス語向けに翻訳し直す必要のあるリソースはごく一部です。 元のアセットはすべて "fr" という指定のまま使い続けることができ、わずかな新しいアセットだけ、"fr-CA" を使って追加します。 ユーザー言語設定が "fr-CA" の場合は、"fr-CA" アセットの方が "fr" アセットよりも一致スコアが高くなります。 しかし、ユーザー言語設定がフランス語の任意の変種である場合は、地域中立の "fr" アセットの方が "fr-CA" アセットよりも一致スコアが高くなります。

別の例として、スペイン出身の人とラテン アメリカ出身の人向けに別々のスペイン語版を用意するとします。 また、ラテン アメリカ用の翻訳はメキシコの業者から提供されたとします。 2 組のリソースに対して、"es-ES" (スペイン) と "es-MX" (メキシコ) を使えばいいのでしょうか。 もしそうした場合は、アルゼンチンやコロンビアのようなラテン アメリカの別の地域出身の人に "es-ES" リソースが使われるという問題が起きます。 この場合、もっといい方法があります。マクロ地域サブタグの "es-419" を使えば、ラテン アメリカやカリブ海の地域出身の人が使うアセットであることを示すことができます。

地域中立言語タグとマクロ地域サブタグは、いくつかの地域バリアントをサポートする場合、非常に効果的です。 必要となる個別アセットの数を最小限に抑えるために、該当する最も広い地域を反映するように言語を指定することができます。 そして、必要に応じてもっと具体的な言語バリアントを追加して、広く適用できるアセットを補います。 修飾子が地域中立言語であるアセットは、そのユーザーに適用されるもっと具体的な地域の修飾子を持つ別のアセットがない限り、どの地域バリアントのユーザーに対しても使われます。 たとえば、"en" アセットはオーストラリア英語ユーザーに一致しますが、"en-053" (オーストラリアまたはニュージーランドで使われている英語) の方がそのユーザーにとっては優れた一致であり、"en-AU" アセットが考えられる限り最善の一致です。

英語は特に注意する必要があります。 アプリに 2 種類の英語変種によるローカライズ版を追加する場合、それは米国英語版か英国英語版、または、"国際" 英語版になる可能性が高くなります。 先に述べたとおり、米国以外の一部の地域は米国のスペル規則に従っていて、Windows の言語の対応付けではこれが考慮されています。 この場合、ある言語バリアント用に地域中立タグの "en" を使うことはお勧めできません。代わりに、"en-GB" と "en-US" を使ってください  (ただし所定のリソースが別のバリアントを必要としない場合は、"en" を使うことができます)。"en-GB" または "en-US" を "en" に置き換えた場合、Windows による正書法の地域の隣接性と干渉します。 第 3 の英語ローカライズ版を追加する場合は、必要に応じて追加するバリアント特有の地域サブタグまたはマクロ地域サブタグを使い (たとえば、"en-CA"、"en-AU"、"en-053")、"en-GB" と "en-US" はそのまま使い続けます。

## <a name="related-topics"></a>関連トピック

* [リソース管理システムでのリソースの照合と選択の仕組み](how-rms-matches-and-chooses-resources.md)
* [BCP-47](https://tools.ietf.org/html/bcp47)
* [ユーザー プロファイルの言語とアプリ マニフェストの言語について](../design/globalizing/manage-language-and-region.md)
* [マクロ地理 (大陸) 地域、地理サブ地域、選ばれた経済グループなどのグループ分けの構成](https://unstats.un.org/unsd/methods/m49/m49regin.htm)
